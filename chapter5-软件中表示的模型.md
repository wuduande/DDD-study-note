# 概述

1. entity: 一个活生生的事物，具有自身的生命周期。在生命周期中，自身会变化。
但不论发生什么改变，它仍旧是它。区别不同entity的唯一方法是依靠entity自身的标识。
如果身份证ID，不论长相，年龄如何变化，ID不变。

2. value: 记录事物的一个瞬态，是处于运动变化状态中实体的一个瞬间状态。
value自身不发生改变。如同一张静态的照片。一个snapshot.是用来描述事物的对象。

小结：世界上的任务事件都可以建模为entity,也可以建模为value.关键在于我们是否持续
关注事物的演变，是否关注其生命周期。还是将仅仅将事物的某个状态用于计算与逻辑。
实体模型注定要投入更多的精力去管理生命周期。尽可能建立value模型。

3. service: 表示一项**无状态**的活动，而非事物。此活动本身没有发起的主体。
比如：下雨、派单、清理缓存等。


# 关联
模型对象之间的关联关系，是指通过一个对象可以找到得到另一个。

**一对多** 的关系可以是一个对象包含另一种对象的引用集合。或者可以
通过某种关联字从数据库中查询到另一种对象的集合。

**对多对** 现实中存在大量的多对多关系，并且通常是双向关联。对多
对关系不利于建模。因此要简化。

**关联的简化**
1. 将双向关联简化为单向。比如，允许根据人查询订单，不允许根据订单查到到人。

2. 窄化关联的范围。将一对多的关系，通过窄化关联概念，转化为一对一的关系。
比如：一个人所关联的上学地点有多个，但**上大学**的地点只有一个。
客户的订单有多个，但**同一时间**只有一个。窄化关联可以使模型更准确
地表达事物的内在逻辑。承载更多的信息。

3. 无必要的关联要去除。如果一种关联关系永远不会用到，就不要做。

**关联的约束** 如果存在，必须建模。比如，火车票系统中，一个用户
在一个车次只能买一张票。那么这种对关联关系的约束必须在模型中体现。

# 实体建模

实体的本质职责是确保事物的在时间上连续性，使其行为清楚、可预测。
保持实体简练是实现这一职责的关键。方法如下：

1. 用实体去捕获至关重要的概念。不要急于确定属性与行为。

2. 只添加对概念至关重要的行为。使概念清晰、完整。

3. 只添加对行为至关重要的属性。

4. 在实体中，仅保留用于查找、识别、匹配实体本身的属性，其它属性要下放到
与此实体关联的其它实体、value中。

5. 除了用于自身的标识（查找、识别、匹配）的行为，其它行为都下放到子
关联对象中，通过协调这些关联对象完成自身的职责。

实体使用不可变的ID作为唯一标识。

# 值建模

“我不需要知道同样属性的物体之间的区别，不在乎其过去，不在乎其将来。”
“值对象是不变的。1永远是1”

**value之间的双向关联**没有意义。value的之间的关联，代表的是对相同
值的所有value之间的关联。因为value之间的区别，仅在于取值。所有的1
都是一样的。如果1关联2，代表所有1与所有2关联。

# service建模

Service对一种活动进行建模。以一个活动进行命名。它建模的是一个动词，
而非名词。被建模的活动应该是通用语言中的组成部分，是重要的领域概念。
其参数与结果都应该是领域模型中的对象。

其特征如下：
1. service建模的行为不是entity与value的自然部分。

2. 接口是根据领域模型的重要概念定义的。（参数、输出均为领域对象）

3. 无状态。 Service不具有封装的状态。

4. Service可以具有副作用。

Service可作为领域模型对应用层提供的接口。封装领域内重要的协调、
调度知识。控制接口的粒度。


